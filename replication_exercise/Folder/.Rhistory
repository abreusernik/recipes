library(ISLR2)
attach(Weekly)
summary(Weekly)
plot(Year, Volume)
plot(Year, Today)
plot(Volume, Today)
LR=glm(Direction~Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data=Weekly, family = binomial)
summary(LR)
plot(Direction, Volume)
plot(Direction, Year)
summary(LR)
contrasts(Direction)
prediction = predict(LR, type = "response")
n = dim(Weekly)[1]
predicted_directions = array("Down", n)
predicted_directions[prediction >= 0.5] = "Up"
confusion = table(Weekly$Direction, predicted_directions)
print(confusion)
getcwd()
setwd("C:\Users")
setwd("C:/Users")
setwd("C:/Users/lucas/Documents/econ_580/Folder")
setwd("C:/Users/Lucas/Documents/econ_580/Folder")
setwd("C:/Users/lucas/Documents/econ_580/replication_exercise/Folder")
# datasets
dir_data="." # the directory of datasets
vocab10K=read.csv(paste0(dir_data,"/vocab10K.csv"),stringsAsFactors = FALSE)
trend=read.csv(paste0(dir_data,"/trend_stats.csv"))
trend$date=as.Date(trend$date)
# Table 1: Top 10 Words Most Predictive of Female/Male Posts
tab1=cbind(vocab10K[order(vocab10K$ME,decreasing=TRUE)[1:10],c("word","ME")],
vocab10K[order(vocab10K$ME,decreasing=FALSE)[1:10],c("word","ME")])
# Table 2: Top 10 Words Most Predictive of Female/Male Posts in the Pronoun Sample
tab2=cbind(vocab10K[order(vocab10K$ME_pronoun,decreasing=TRUE)[1:10],c("word","ME_pronoun")],
vocab10K[order(vocab10K$ME_pronoun,decreasing=FALSE)[1:10],c("word","ME_pronoun")])
library(ggplot2)
ggplot(trend,aes(x=date))+
geom_point(aes(y=frac,color=as.factor(female),shape=as.factor(female)))+
geom_point(aes(y=frac_pronoun,color=as.factor(female),shape=as.factor(female)))+
geom_line(aes(y=frac,color=as.factor(female)))+
geom_line(aes(y=frac_pronoun,color=as.factor(female)),linetype=2)+
scale_color_manual(values=c("#56B4E9","#CC79A7"),labels=c("Male","Female"))+
scale_shape_discrete(labels=c("Male","Female"))+
scale_x_date(date_breaks="1 month",date_labels =  "%b %Y")+
scale_y_continuous(breaks=seq(0.05,0.20,by=0.05),limits=c(0.05,0.20))+
xlab("Month of the Latest Update")+ylab("Fraction of Female (Male) Posts")+
theme(legend.position="bottom",legend.title=element_blank(),panel.background = element_blank(),
axis.line = element_line(colour = "black"),axis.title=element_text(size=10),
axis.text.x=element_text(angle = 90,vjust=-0.005,size=9))
